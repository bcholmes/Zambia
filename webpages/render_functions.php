<?php
//	Copyright (c) 2007-2021 Peter Olszowka. All rights reserved. See copyright document for more details.
//	RenderPrecis display requires:  a query result containing rows with these fields IN THIS ORDER:
//	$sessionid, $trackname, $typename, $title, $duration, $estatten, $progguiddesc, $persppartinfo, $starttime, $roomname, $statusname
//	it displays the precis view of the data.
function RenderPrecis($result, $showlinks) {
    echo "<div class=\"alert alert-info mt-3\">Generated by Zambia: " . date('d-M-Y h:i A') . "</div>\n";
    if (mysqli_num_rows($result) < 1) {
        echo "<p class=\"alert alert-warning\">No matching results found.</p>";
        return;
    }
    echo "<div class=\"card\"><div class=\"card-body\">";
    echo "<p>If a room name and time are listed, then the session is on the schedule; otherwise, not.</p>";
    echo "<table class=\"table table-sm\">\n";
    while (list($sessionid, $trackname, $typename, $title, $duration, $estatten, $progguiddesc, $persppartinfo, $starttime, $roomname, $statusname, $taglist)
        = mysqli_fetch_array($result, MYSQLI_NUM)) {
        echo "<tr>\n";
        echo "  <th rowspan=\"3\" id=\"sessidtcell\">";
        if ($showlinks) {
            echo "<a href=\"StaffAssignParticipants.php?selsess=" . $sessionid . "\">" . $sessionid . "</a>";
        }
        echo "&nbsp;&nbsp;</th>\n";
        if (TRACK_TAG_USAGE !== "TAG_ONLY") {
            echo "  <td>" . $trackname . "</td>\n";
            echo "  <td>" . $typename . "</td>\n";
        } else {
            echo "  <td colspan=\"2\">" . $typename . "</td>\n";
        }
        echo "  <td style=\"font-weight:bold\">";
        if ($showlinks) {
            echo "<a href=\"EditSession.php?id=" . $sessionid . "\">" . htmlspecialchars($title, ENT_NOQUOTES) . "</a>";
        } else {
            echo htmlspecialchars($title, ENT_NOQUOTES);
        }
        echo "&nbsp;&nbsp;</td>\n";
        echo "  <td>" . $duration . "</td>\n";
        echo "  <td>";
        if ($roomname) {
            echo $roomname;
        } else {
            echo "&nbsp;";
        }
        echo "</td>\n";
        echo "  <td>";
        if ($starttime) {
            echo $starttime;
        } else {
            echo "&nbsp;";
        }
        echo "</td>\n";
        echo "    <td>$statusname</td>\n";
        if ($showlinks) {
            echo "    <td><a class=\"btn btn-sm btn-outline-secondary\" href=\"SessionHistory.php?selsess=$sessionid\">History</a></td>\n";
        } else {
            echo "<td></td>";
        }
        echo "</tr>\n";
        echo "<tr>";
        echo "    <td colspan=\"2\">" . htmlspecialchars($taglist, ENT_NOQUOTES) . "</td>";
        echo "    <td colspan=\"6\">" . htmlspecialchars($progguiddesc, ENT_NOQUOTES) . "</td>";
        echo "</tr>\n";
        if ($persppartinfo) {
            echo "<tr><td></td>";
            echo "<td colspan=\"2\">Prospective Participant Info: </td>";
            echo "<td colspan=\"6\">".htmlspecialchars($persppartinfo,ENT_NOQUOTES)."</td>";
            echo "</tr>\n";
        } else {
            echo "<tr><td colspan=\"8\">&nbsp;</td></tr>\n";
        }
    }
    echo "</table>\n";
    echo "</div></div>";
}
?>
